import telebot
import os
import logging
import time
import threading
import random
from telebot import types

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
logging.basicConfig(level=logging.INFO)

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–π —Ä–∞–±–æ—á–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
print(f'—Ç–µ–∫—É—â–∞—è —Ä–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è: {os.getcwd()}')

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram-–±–æ—Ç–∞
API_TOKEN = 'YOUR_API_TOKEN_HERE'
bot = telebot.TeleBot(API_TOKEN)

# –°–ø–∏—Å–æ–∫ —Ñ–∞–∫—Ç–æ–≤
facts = [
    "–í–æ–¥–∞ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç –æ–∫–æ–ª–æ 70% –º–∞—Å—Å—ã —Ç–µ–ª–∞ –≤–∑—Ä–æ—Å–ª–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞.",
    "–ü–∏—Ç—å–µ–≤–∞—è –≤–æ–¥–∞ –ø–æ–º–æ–≥–∞–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –∑–¥–æ—Ä–æ–≤—ã–π –±–∞–ª–∞–Ω—Å –∂–∏–¥–∫–æ—Å—Ç–∏ –≤ –≤–∞—à–µ–º —Ç–µ–ª–µ.",
    "–í–∞—à –º–æ–∑–≥ –∏ —Å–µ—Ä–¥—Ü–µ —Å–æ—Å—Ç–æ—è—Ç –ø—Ä–∏–º–µ—Ä–Ω–æ –Ω–∞ 73% –∏–∑ –≤–æ–¥—ã.",
    "–í–æ–¥–∞ –ø–æ–º–æ–≥–∞–µ—Ç —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É —Ç–µ–ª–∞.",
    "–£–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –≤–æ–¥—ã –º–æ–∂–µ—Ç –ø–æ–º–æ—á—å –≤–∞–º —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–∏—Ç—å—Å—è –∏ –ø–æ–≤—ã—Å–∏—Ç—å –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—é.",
    "–í–æ–¥–∞ –º–æ–∂–µ—Ç –ø–æ–º–æ—á—å —É–ª—É—á—à–∏—Ç—å —ç–Ω–µ—Ä–≥–∏—é –∏ —É–º–µ–Ω—å—à–∏—Ç—å —É—Å—Ç–∞–ª–æ—Å—Ç—å.",
    "–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —É–ø–æ—Ç—Ä–µ–±–ª—è—Ç—å –æ–∫–æ–ª–æ 2-2,5 –ª–∏—Ç—Ä–æ–≤ –≤–æ–¥—ã –≤ –¥–µ–Ω—å –¥–ª—è –∂–µ–Ω—â–∏–Ω –∏ –æ–∫–æ–ª–æ 3 –ª–∏—Ç—Ä–æ–≤ –¥–ª—è –º—É–∂—á–∏–Ω."
    " –≠—Ç–æ –≤–∫–ª—é—á–∞–µ—Ç –≤—Å–µ –∂–∏–¥–∫–æ—Å—Ç–∏, –ø–æ–ª—É—á–∞–µ–º—ã–µ –∏–∑ –Ω–∞–ø–∏—Ç–∫–æ–≤ –∏ –ø–∏—â–∏.",
    "–õ—É—á—à–µ –≤—Å–µ–≥–æ –ø–∏—Ç—å –≤–æ–¥—É —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ –≤ —Ç–µ—á–µ–Ω–∏–µ –¥–Ω—è, –Ω–µ –¥–æ–∂–∏–¥–∞—è—Å—å –ø–æ—è–≤–ª–µ–Ω–∏—è —á—É–≤—Å—Ç–≤–∞ –∂–∞–∂–¥—ã."
    " –ù–∞–ø—Ä–∏–º–µ—Ä, –º–æ–∂–Ω–æ –≤—ã–ø–∏–≤–∞—Ç—å —Å—Ç–∞–∫–∞–Ω –≤–æ–¥—ã —É—Ç—Ä–æ–º –ø–æ—Å–ª–µ –ø—Ä–æ–±—É–∂–¥–µ–Ω–∏—è, –∑–∞—Ç–µ–º –ø–∏—Ç—å –≤–æ–¥—É –º–µ–∂–¥—É"
    " –ø—Ä–∏–µ–º–∞–º–∏ –ø–∏—â–∏ –∏ –≤–æ –≤—Ä–µ–º—è –∏–ª–∏ –ø–æ—Å–ª–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫.",
    "–ü–æ–∂–∏–ª—ã–º –ª—é–¥—è–º —Å–ª–µ–¥—É–µ—Ç —Å–ª–µ–¥–∏—Ç—å –∑–∞ —Ç–µ–º, —á—Ç–æ–±—ã –Ω–µ –¥–æ–ø—É—Å–∫–∞—Ç—å –æ–±–µ–∑–≤–æ–∂–∏–≤–∞–Ω–∏—è, —Ç–∞–∫ –∫–∞–∫"
    " —Å –≤–æ–∑—Ä–∞—Å—Ç–æ–º —á—É–≤—Å—Ç–≤–æ –∂–∞–∂–¥—ã –º–æ–∂–µ—Ç –ø—Ä–∏—Ç—É–ø–ª—è—Ç—å—Å—è. –î–µ—Ç—è–º —Ç–∞–∫–∂–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–ª–µ–¥–∏—Ç—å –∑–∞"
    " –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–º –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ–º –∂–∏–¥–∫–æ—Å—Ç–∏, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –±–æ–ª–µ–µ –∞–∫—Ç–∏–≤–Ω—ã –∏ —Ç–µ—Ä—è—Ç—å –±–æ–ª—å—à–µ –≤–æ–¥—ã.",
    "–ü—Ä–∏ –ø–æ–≤—ã—à–µ–Ω–Ω–æ–π —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏–ª–∏ –≤ –∂–∞—Ä–∫–æ–º –∫–ª–∏–º–∞—Ç–µ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å –≤ –≤–æ–¥–µ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è."
    " –í —Ç–∞–∫–∏—Ö —É—Å–ª–æ–≤–∏—è—Ö –≤–∞–∂–Ω–æ –ø–∏—Ç—å –±–æ–ª—å—à–µ, —á—Ç–æ–±—ã –∫–æ–º–ø–µ–Ω—Å–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Ç–µ—Ä—é –∂–∏–¥–∫–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ –ø–æ—Ç–æ–æ—Ç–¥–µ–ª–µ–Ω–∏–µ.",
    "–í–∞–∂–Ω–æ –ø—Ä–∏—Å–ª—É—à–∏–≤–∞—Ç—å—Å—è –∫ —Å–≤–æ–µ–º—É –æ—Ä–≥–∞–Ω–∏–∑–º—É: –µ—Å–ª–∏ –≤—ã —á—É–≤—Å—Ç–≤—É–µ—Ç–µ –∂–∞–∂–¥—É, —ç—Ç–æ —Å–∏–≥–Ω–∞–ª –æ —Ç–æ–º, —á—Ç–æ –Ω—É–∂–Ω–æ –≤—ã–ø–∏—Ç—å –≤–æ–¥—ã."
    " –¢–∞–∫–∂–µ —Å–ª–µ–¥—É–µ—Ç –ø–æ–º–Ω–∏—Ç—å, —á—Ç–æ —á—Ä–µ–∑–º–µ—Ä–Ω–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –≤–æ–¥—ã –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –≤–æ–¥–Ω–æ–π –∏–Ω—Ç–æ–∫—Å–∏–∫–∞—Ü–∏–∏,"
    " –ø–æ—ç—Ç–æ–º—É –≤–∞–∂–Ω–æ —Å–æ–±–ª—é–¥–∞—Ç—å –±–∞–ª–∞–Ω—Å."
    "–î–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è –≤—ã—Å–æ–∫–æ–π —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ —Ä–∞–±–æ—á–µ–≥–æ –¥–Ω—è —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–µ–ª–∞—Ç—å —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –ø–µ—Ä–µ—Ä—ã–≤—ã."
    " –û–¥–∏–Ω –∏–∑ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –ø–æ–¥—Ö–æ–¥–æ–≤ ‚Äî —ç—Ç–æ —Ç–µ—Ö–Ω–∏–∫–∞ –ü–æ–º–∏–¥–æ—Ä–æ, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç —Ä–∞–±–æ—Ç—É –≤ —Ç–µ—á–µ–Ω–∏–µ 25 –º–∏–Ω—É—Ç,"
    " –∞ –∑–∞—Ç–µ–º –ø–µ—Ä–µ—Ä—ã–≤ –Ω–∞ 5 –º–∏–Ω—É—Ç. –ü–æ—Å–ª–µ —á–µ—Ç—ã—Ä–µ—Ö —Ç–∞–∫–∏—Ö —Ü–∏–∫–ª–æ–≤ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–µ–ª–∞—Ç—å –±–æ–ª–µ–µ –¥–ª–∏—Ç–µ–ª—å–Ω—ã–π –ø–µ—Ä–µ—Ä—ã–≤,"
    " –æ–∫–æ–ª–æ 15-30 –º–∏–Ω—É—Ç.",
    "–î–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è –≤—ã—Å–æ–∫–æ–π —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ —Ä–∞–±–æ—á–µ–≥–æ –¥–Ω—è –ø—Ä–µ–¥–ª–∞–≥–∞—é—Ç –¥–µ–ª–∞—Ç—å –ø–µ—Ä–µ—Ä—ã–≤—ã –∫–∞–∂–¥—ã–µ 60-90 –º–∏–Ω—É—Ç, –ø–æ—Å–∫–æ–ª—å–∫—É —ç—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç"
    " –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–º —Ä–∏—Ç–º–∞–º –Ω–∞—à–µ–≥–æ —Ç–µ–ª–∞, —Ç–∞–∫–∏–º –∫–∞–∫ —É–ª—å—Ç—Ä–∞–¥–∏–∞–Ω–Ω—ã–π —Ä–∏—Ç–º. –í–∞–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å, —á—Ç–æ –ø–µ—Ä–µ—Ä—ã–≤—ã"
    " –¥–æ–ª–∂–Ω—ã –≤–∫–ª—é—á–∞—Ç—å –≤ —Å–µ–±—è —Å–º–µ–Ω—É –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–µ–±–æ–ª—å—à—É—é –ø—Ä–æ–≥—É–ª–∫—É, —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è"
    " –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ –æ—Ç–¥—ã—Ö –æ—Ç —ç–∫—Ä–∞–Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ ‚Äî —á—Ç–æ–±—ã –ø–æ–º–æ—á—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—é –∏ —ç–Ω–µ—Ä–≥–∏—é."
]

# –§–ª–∞–≥ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
notify_enabled = {}

# –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ç–∞–π–º–µ—Ä–∞
timers = {}
paused = {}
stop_flags = {}

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫
def error_handler(func):
    def wrapper(*args, **kwargs):
        try:
            return func(*args, **kwargs)
        except Exception as e:
            logging.error(f"–û—à–∏–±–∫–∞: {e}")
            bot.send_message(args[0].chat.id, "–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞! –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.")
    return wrapper

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π –æ —á–∏—Å—Ç–æ–π –≤–æ–¥–µ
def send_water_reminder(chat_id):
    while True:
        try:
            bot.send_message(chat_id, "–ù–µ –∑–∞–±—É–¥—å—Ç–µ –≤—ã–ø–∏—Ç—å —á–∏—Å—Ç–æ–π –≤–æ–¥—ã! üíß")
            time.sleep(3000)  # –ö–∞–∂–¥–æ–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –∫–∞–∂–¥—ã–µ 50 –º–∏–Ω—É—Ç
        except Exception as e:
            logging.error(f"–û—à–∏–±–∫–∞ –≤ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è—Ö –æ –≤–æ–¥–µ: {e}")
            break  # –ü—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ –ø–æ—Ç–æ–∫–∞ –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ç–∞–π–º–µ—Ä–∞
def start_timer(chat_id, work_time, break_time):
    def timer_cycle():
        # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–∞–π–º–µ—Ä–∞, —Å–±—Ä–æ—Å "elapsed" –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –Ω–æ–≤–æ–≥–æ —Ç–∞–π–º–µ—Ä–∞
        timers[chat_id] = {"elapsed": 0, "is_running": True}
        stop_flags[chat_id] = False

        while not stop_flags[chat_id]:
            if paused.get(chat_id, False):
                time.sleep(1)
                continue

            # –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞ –ø–∞—É–∑—É –∏ –æ–±–Ω–æ–≤–ª—è–µ–º elapsed —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Ä–∞–±–æ—Ç–∞—é—â–µ–º —Ç–∞–π–º–µ—Ä–µ
           # if not paused.get(chat_id, False):
            #    elapsed_time += 1
             #   timers[chat_id]["elapsed"] = elapsed_time

            bot.send_message(chat_id, f"–í—Ä–µ–º—è —Ä–∞–±–æ—Ç–∞—Ç—å! –°–ª–µ–¥—É—é—â–∏–µ {work_time} –º–∏–Ω—É—Ç.")
            elapsed_time = timers[chat_id]["elapsed"]
            work_seconds = work_time * 60

            for elapsed_time in range(timers[chat_id]["elapsed"], work_seconds):
                if stop_flags.get(chat_id, False):
                    timers[chat_id]["elapsed"] = 0  # –°–±—Ä–æ—Å –ø—Ä–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ
                    break
                if paused.get(chat_id, False):
                    timers[chat_id]["elapsed"] = elapsed_time
                    break
                time.sleep(1)

                # –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ —Ç–∞–π–º–µ—Ä–∞
                timers[chat_id]["elapsed"] = elapsed_time

                # –ö–∞–∂–¥—ã–µ 300 —Å–µ–∫—É–Ω–¥ –æ–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º—è
                if elapsed_time % 300 == 0:
                    bot.send_message(chat_id, f"–ü—Ä–æ—à–ª–æ {elapsed_time // 60} –º–∏–Ω—É—Ç {elapsed_time % 60} —Å–µ–∫—É–Ω–¥ —Ä–∞–±–æ—Ç—ã.")

            if stop_flags.get(chat_id, False):
                timers[chat_id]["elapsed"] = 0
                break

            if not paused.get(chat_id, False):
                timers[chat_id]["elapsed"] = 0  # –°–±—Ä–æ—Å elapsed –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞–±–æ—á–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
                bot.send_message(chat_id, f"–í—Ä–µ–º—è –Ω–∞ –ø–µ—Ä–µ—Ä—ã–≤! –û—Ç–¥—ã—Ö–∞–π—Ç–µ {break_time} –º–∏–Ω—É—Ç.")
                time.sleep(break_time * 60)

    thread = threading.Thread(target=timer_cycle)
    thread.start()


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /start
@bot.message_handler(commands=['start'])
def start_message(message):
    bot.reply_to(message, '–ü—Ä–∏–≤–µ—Ç! –Ø —á–∞—Ç –±–æ—Ç, –±—É–¥—É –ø–æ–º–æ–≥–∞—Ç—å —Ç–µ–±–µ —Å —Ä–µ–∂–∏–º–æ–º —Ç—Ä—É–¥–∞\n–∏ –æ—Ç–¥—ã—Ö–∞, '
                          '–Ω—É–∂–Ω–æ –≤–æ–≤—Ä–µ–º—è –æ—Ç–¥—ã—Ö–∞—Ç—å –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è\n–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –Ω–µ –∑–∞–±—ã–≤–∞—Ç—å –ø–∏—Ç—å —á–∏—Å—Ç—É—é –≤–æ–¥—É! üíß\n'
                          '\n–í—ã–±–µ—Ä–∏ –ø–æ–¥—Ö–æ–¥—è—â–∏–π —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã –∏ –æ—Ç–¥—ã—Ö–∞:'
                 '\n–í–∞—Ä–∏–∞–Ω—Ç 1: (25/5) –∏–ª–∏ –í–∞—Ä–∏–∞–Ω—Ç 2: (50/10)')
    markup = types.ReplyKeyboardMarkup(resize_keyboard=True)
    btn1 = types.KeyboardButton('–í–∞—Ä–∏–∞–Ω—Ç 1: (25/5)')
    btn2 = types.KeyboardButton('–í–∞—Ä–∏–∞–Ω—Ç 2: (50/10)')
    markup.add(btn1, btn2)
    bot.send_message(message.chat.id, '–í—ã–±–µ—Ä–∏ –∫–Ω–æ–ø–∫—É —Å –≤–∞—Ä–∏–∞–Ω—Ç–æ–º:', reply_markup=markup)


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞–∂–∞—Ç–∏–π –Ω–∞ –∫–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞ —Ä–µ–∂–∏–º–∞
@bot.message_handler(func=lambda message: message.text in ['–í–∞—Ä–∏–∞–Ω—Ç 1: (25/5)', '–í–∞—Ä–∏–∞–Ω—Ç 2: (50/10)'])
def handle_choice(message):
    chat_id = message.chat.id
    markup = types.ReplyKeyboardMarkup(resize_keyboard=True)
    pause_btn = types.KeyboardButton('/pause_timer')
    stop_btn = types.KeyboardButton('/stop_timer')
    resume_timer_btn = types.KeyboardButton('/resume_timer')
    markup.add(pause_btn, stop_btn, resume_timer_btn)

    if message.text == '–í–∞—Ä–∏–∞–Ω—Ç 1: (25/5)':
        work_time, break_time = 25, 5
    elif message.text == '–í–∞—Ä–∏–∞–Ω—Ç 2: (50/10)':
        work_time, break_time = 50, 10

    bot.send_message(chat_id, f"–í—ã –≤—ã–±—Ä–∞–ª–∏ –í–∞—Ä–∏–∞–Ω—Ç: {work_time} –º–∏–Ω—É—Ç —Ä–∞–±–æ—Ç—ã, {break_time} –º–∏–Ω—É—Ç –ø–µ—Ä–µ—Ä—ã–≤–∞.", reply_markup=markup)
    stop_flags[chat_id] = False
    # –ó–∞–ø—É—Å–∫ —Ç–∞–π–º–µ—Ä–∞ —Å –≤—ã–±—Ä–∞–Ω–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
    start_timer(chat_id, work_time, break_time)

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /pause_timer
@bot.message_handler(commands=['pause_timer'])
def pause_timer(message):
    chat_id = message.chat.id
    if chat_id in timers:
        paused[chat_id] = True
        bot.send_message(chat_id, "–¢–∞–π–º–µ—Ä –Ω–∞ –ø–∞—É–∑–µ.")
    else:
        bot.send_message(chat_id, "–¢–∞–π–º–µ—Ä –µ—â–µ –Ω–µ –±—ã–ª –∑–∞–ø—É—â–µ–Ω.")

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /stop_timer
@bot.message_handler(commands=['stop_timer'])
def stop_timer(message):
    chat_id = message.chat.id
    if chat_id in timers:
        stop_flags[chat_id] = True
        paused[chat_id] = False
        timers[chat_id]["elapsed"] = 0  # –°–±—Ä–æ—Å –≤—Ä–µ–º–µ–Ω–∏
        bot.send_message(chat_id, "–¢–∞–π–º–µ—Ä –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ —Å–±—Ä–æ—à–µ–Ω.")
    else:
        bot.send_message(chat_id, "–¢–∞–π–º–µ—Ä –µ—â–µ –Ω–µ –±—ã–ª –∑–∞–ø—É—â–µ–Ω.")

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /resume_timer
@bot.message_handler(commands=['resume_timer'])
def resume_timer(message):
    chat_id = message.chat.id
    if chat_id in timers and paused.get(chat_id, False):
        paused[chat_id] = False
        bot.send_message(chat_id, "–¢–∞–π–º–µ—Ä –≤–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω.")
    else:
        bot.send_message(chat_id, "–¢–∞–π–º–µ—Ä –Ω–µ –±—ã–ª –Ω–∞ –ø–∞—É–∑–µ –∏–ª–∏ –µ—â–µ –Ω–µ –∑–∞–ø—É—â–µ–Ω.")

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /time
@bot.message_handler(commands=['time'])
def send_time(message):
    chat_id = message.chat.id
    if chat_id in timers:
        elapsed = timers[chat_id].get("elapsed", 0)
        minutes, seconds = divmod(elapsed, 60)
        bot.reply_to(message, f"–ü—Ä–æ—à–ª–æ {minutes} –º–∏–Ω—É—Ç {seconds} —Å–µ–∫—É–Ω–¥.")
    else:
        bot.reply_to(message, "–¢–∞–π–º–µ—Ä –µ—â–µ –Ω–µ –∑–∞–ø—É—â–µ–Ω.")


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /help
@bot.message_handler(commands=['help'])
@error_handler
def send_help(message):
    help_text = (
        "/start - –ù–∞—á–∞—Ç—å –æ–±—â–µ–Ω–∏–µ —Å –±–æ—Ç–æ–º\n"
        "/help - –ü–æ–∫–∞–∑–∞—Ç—å —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–æ–º–∞–Ω–¥–∞–º–∏\n"
        "/reminder - –ù–∞—á–∞—Ç—å –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ –ø–∏—Ç—å–µ –≤–æ–¥—ã\n"
        "/fact - –ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π —Ñ–∞–∫—Ç –æ –≤–æ–¥–µ üíß –∏ –Ω–µ —Ç–æ–ª—å–∫–æ\n"
        "/time - –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–æ—à–µ–¥—à–µ–µ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã\n"
        "/pause_timer - –ü–æ—Å—Ç–∞–≤–∏—Ç—å —Ç–∞–π–º–µ—Ä –Ω–∞ –ø–∞—É–∑—É\n"
        "/stop_timer - –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–∞–π–º–µ—Ä\n"
        "/resume_timer - –í–æ–∑–æ–±–Ω–æ–≤–∏—Ç—å —Ç–∞–π–º–µ—Ä\n"
    )
    markup = types.ReplyKeyboardMarkup(resize_keyboard=True)
    pause_btn = types.KeyboardButton('/pause_timer')
    stop_btn = types.KeyboardButton('/stop_timer')
    resume_timer_btn = types.KeyboardButton('/resume_timer')
    markup.add(pause_btn, stop_btn, resume_timer_btn)
    bot.send_message(message.chat.id, help_text, reply_markup=markup)

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /reminder
@bot.message_handler(commands=['reminder'])
@error_handler
def start_reminder(message):
    thread = threading.Thread(target=send_water_reminder, args=(message.chat.id,))
    thread.start()
    bot.reply_to(message, "–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ –ø–∏—Ç—å–µ –≤–æ–¥—ã –≤–∫–ª—é—á–µ–Ω—ã!üíß")

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /fact
@bot.message_handler(commands=['fact'])
@error_handler
def send_fact(message):
    fact = random.choice(facts)
    bot.reply_to(message, fact)


# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
if __name__ == "__main__":
    logging.info("–ó–∞–ø—É—Å–∫ –±–æ—Ç–∞")
    bot.polling(none_stop=True, timeout=10, long_polling_timeout=20)
